/*--------------------------------*- C++ -*----------------------------------*\
  =========                 |
  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
   \\    /   O peration     | Website:  https://openfoam.org
    \\  /    A nd           | Version:  13
     \\/     M anipulation  |
\*---------------------------------------------------------------------------*/
FoamFile
{
    version     2.0;
    format      ascii;
    class       dictionary;
    location    "system";
    object      blockMeshDict;
}
// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //

convertToMeters 1.0;

D 1.0;
W 1.5;
H 0.75;

angDeg 45;

DIn 3.0;
DOut 5.0;
RB 3.0;


nx     45; 
ny     22; 
nBC    10;
inAx   30; 
bendAx 40;
outAx  50;


ang #calc "degToRad($angDeg)";

xi #calc "0.5 * $W";
yi #calc "0.5 * $H";
mxi #calc "-1.0 * $xi";
myi #calc "-1.0 * $yi";

XB #calc "-1.0* $RB";
zbi #calc "$DIn + $RB + $xi";
mzbi #calc "$DIn + $RB + $mxi";


XACII #calc "-$RB + ($RB-$xi)*sin($ang)";
ZACII #calc "$DIn + ($RB-$xi)*cos($ang)";


XACOI #calc "-$RB + ($RB+$xi)*sin($ang)";
ZACOI #calc "$DIn + ($RB+$xi)*cos($ang)";


XBE #calc "$XB - $DOut";


vertices
(
    
    ($mxi $yi 0)    // 0
    ($xi $yi 0)     // 1 
    ($xi $myi 0)    // 2
    ($mxi $myi 0)   // 3

    ($mxi $yi $DIn)    // 4
    ($xi $yi $DIn)     // 5 
    ($xi $myi $DIn)    // 6
    ($mxi $myi $DIn)   // 7


    ($XB $yi $mzbi)    // 8
    ($XB $yi  $zbi)    // 9 
    ($XB $myi $zbi)    // 10
    ($XB $myi $mzbi)   // 11

    ($XBE $yi $mzbi)    // 12
    ($XBE $yi  $zbi)    // 13 
    ($XBE $myi $zbi)    // 14
    ($XBE $myi $mzbi)   // 15
    
   
);

xDis 0.6;
xBL #calc "(1.0 - $xDis) / 2";

xCell 0.33;
xCellBC #calc "(1.0 - $xCell)/2";

xExp 0.2;
xExpInv #calc "1 / $xExp";

yDis 0.8;
yBL #calc "(1.0 - $yDis) / 2";

yCell 0.33; 
yCellBC #calc "(1.0 - $yCell)/2";

yExp 0.2;
yExpInv #calc "1 / $yExp";



blocks
(   
    hex (3 2 1 0 7 6 5 4) ($nx $ny $inAx) simpleGrading 
     (
        (
            ($xBL $xCellBC $xExpInv)
            ($xDis $xCell 1)    
            ($xBL $xCellBC $xExp)  
        )                 
        (
            ($yBL $yCellBC $yExpInv)
            ($yDis $yCell 1)    
            ($yBL $yCellBC $yExp)  
        )
        1                  
    )
    
    hex (7 6 5 4 11 10 9 8) ($nx $ny $bendAx) simpleGrading 
    (
        (
            ($xBL $xCellBC $xExpInv)
            ($xDis $xCell 1)    
            ($xBL $xCellBC $xExp)  
        )                 
        (
            ($yBL $yCellBC $yExpInv)
            ($yDis $yCell 1)    
            ($yBL $yCellBC $yExp)  
        )
        1                  
    )
    hex (11 10 9 8 15 14 13 12) ($nx $ny $outAx) simpleGrading 
    (
        (
            ($xBL $xCellBC $xExpInv)
            ($xDis $xCell 1)    
            ($xBL $xCellBC $xExp)  
        )                 
        (
            ($yBL $yCellBC $yExpInv)
            ($yDis $yCell 1)    
            ($yBL $yCellBC $yExp)  
        )
        1                          
    )  

);

edges
(
    
    arc 4 8 ($XACII $yi $ZACII)
    arc 7 11 ($XACII $myi $ZACII)
    arc 5 9 ($XACOI $yi $ZACOI)
    arc 6 10 ($XACOI $myi $ZACOI)
    
);

defaultPatch
{
    name walls; 
    type wall;
}

boundary
(
    
    inlet
    {
        type patch;
        faces
        (
            (3 2 1 0)

        );
    }
    
    outlet
    {
        type patch;
        faces
        (
            (12 13 14 15)
    
        );
    }
    
);

mergePatchPairs();
